<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.ai.mapper.InterviewRecordsMapper">

    <select id="getInterviewRecordsByPage" resultType="com.ruoyi.ai.domain.InterviewRecords">
        select content, category, subject, session_id
        from ai_interview_interview_records
        where session_id in ( select *
        from ( select distinct session_id
        from ai_interview_interview_records
        where del_flag = 1
        <if test="subject != null and subject != 'all'">
            and subject = #{subject}
        </if>
        AND openid = #{openid} LIMIT #{offset}
        , #{limit}) as t1)
        AND role = 'assistant'

<!--        SELECT content,category,subject,session_id-->
<!--        FROM ai_interview_interview_records-->
<!--        WHERE del_flag = 1-->
<!--        AND openid = #{openid}-->
<!--        AND role = 'assistant'-->
<!--        <if test="subject != null and subject != 'all'">-->
<!--            AND subject = #{subject}-->
<!--        </if>-->
<!--        ORDER BY create_time asc-->
<!--        LIMIT #{offset}, #{limit}-->
    </select>
</mapper>
